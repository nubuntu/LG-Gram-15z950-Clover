into method label B1B2 remove_entry;
into definitionblock code_regex . insert
begin
Method (B1B2, 2, NotSerialized) { Return (Or (Arg0, ShiftLeft (Arg1, 8))) }\n
end;

# utility methods to read/write buffers from/to EC
into method label RE1B parent_label H_EC remove_entry;
into method label RECB parent_label H_EC remove_entry;
into device label H_EC insert
begin
Method (RE1B, 1, NotSerialized)\n
{\n
    OperationRegion(ERAM, EmbeddedControl, Arg0, 1)\n
    Field(ERAM, ByteAcc, NoLock, Preserve) { BYTE, 8 }\n
    Return(BYTE)\n
}\n
Method (RECB, 2, Serialized)\n
// Arg0 - offset in bytes from zero-based EC\n
// Arg1 - size of buffer in bits\n
{\n
    ShiftRight(Arg1, 3, Arg1)\n
    Name(TEMP, Buffer(Arg1) { })\n
    Add(Arg0, Arg1, Arg1)\n
    Store(0, Local0)\n
    While (LLess(Arg0, Arg1))\n
    {\n
        Store(RE1B(Arg0), Index(TEMP, Local0))\n
        Increment(Arg0)\n
        Increment(Local0)\n
    }\n
    Return(TEMP)\n
}\n
end;

# 16-bit registers
into device label H_EC code_regex B1DC,\s+16, replace_matched begin BDC0,8,BDC1,8, end;
into device label H_EC code_regex B1RC,\s+16, replace_matched begin BRC0,8,BRC1,8, end;
into device label H_EC code_regex B1FC,\s+16, replace_matched begin BFC0,8,BFC1,8, end;
into device label H_EC code_regex B1FV,\s+16, replace_matched begin BFV0,8,BFV1,8, end;
into device label H_EC code_regex B1DI,\s+16, replace_matched begin BDI0,8,BDI1,8, end;
into device label H_EC code_regex B1CI,\s+16, replace_matched begin BCI0,8,BCI1,8, end;
into device label H_EC code_regex B2RC,\s+16, replace_matched begin BRC2,8,BRC3,8, end;
into device label H_EC code_regex B2FC,\s+16, replace_matched begin BFC2,8,BFC3,8, end;
into device label H_EC code_regex B2FV,\s+16, replace_matched begin BFV2,8,BFV3,8, end;
into device label H_EC code_regex B2DI,\s+16, replace_matched begin BDI2,8,BDI3,8, end;
into device label H_EC code_regex B2CI,\s+16, replace_matched begin BCI2,8,BCI3,8, end;
into device label H_EC code_regex B1DV,\s+16, replace_matched begin BDV0,8,BDV1,8, end;

# fix 16-bit methods
# B1DC 
into method label _BIF code_regex \ECRD\s\(RefOf\s\(B1DC\)\) replaceall_matched begin B1B2(BDC0,BDC1) end;
into method label _BIX code_regex \ECRD\s\(RefOf\s\(B1DC\)\) replaceall_matched begin B1B2(BDC0,BDC1) end;

# B1RC
into method label _BST code_regex \ECRD\s\(RefOf\s\(B1RC\)\) replaceall_matched begin B1B2(BRC0,BRC1) end;

# B1FC
into method label _BIF code_regex \ECRD\s\(RefOf\s\(B1FC\)\) replaceall_matched begin B1B2(BFC0,BFC1) end;
into method label _BIX code_regex \ECRD\s\(RefOf\s\(B1FC\)\) replaceall_matched begin B1B2(BFC0,BFC1) end;
into method label _BLT code_regex \ECRD\s\(RefOf\s\(B1FC\)\) replaceall_matched begin B1B2(BFC0,BFC1) end;
into method label _BTP code_regex \ECRD\s\(RefOf\s\(B1FC\)\) replaceall_matched begin B1B2(BFC0,BFC1) end;

# B1FV
into method label _BLT code_regex \ECRD\s\(RefOf\s\(B1FV\)\) replaceall_matched begin B1B2(BFV0,BFV1) end;
into method label _BST code_regex \ECRD\s\(RefOf\s\(B1FV\)\) replaceall_matched begin B1B2(BFV0,BFV1) end;
into method label _BTP code_regex \ECRD\s\(RefOf\s\(B1FV\)\) replaceall_matched begin B1B2(BFV0,BFV1) end;

# B1DI
into method label _BST code_regex \ECRD\s\(RefOf\s\(B1DI\)\) replaceall_matched begin B1B2(BDI0,BDI1) end;

# B1CI
into method label _BST code_regex \ECRD\s\(RefOf\s\(B1CI\)\) replaceall_matched begin B1B2(BCI0,BCI1) end;

# B2RC
into method label _BST code_regex \ECRD\s\(RefOf\s\(B2RC\)\) replaceall_matched begin B1B2(BRC2,BRC3) end;

# B2FC
into method label _BIF code_regex \ECRD\s\(RefOf\s\(B2FC\)\) replaceall_matched begin B1B2(BFC2,BFC3) end;

# B2FV
into method label _BST code_regex \ECRD\s\(RefOf\s\(B2FV\)\) replaceall_matched begin B1B2(BFV2,BFV3) end;

# B2DI
into method label _BST code_regex \ECRD\s\(RefOf\s\(B2DI\)\) replaceall_matched begin B1B2(BDI2,BDI3) end;

# B2CI
into method label _BST code_regex \ECRD\s\(RefOf\s\(B2CI\)\) replaceall_matched begin B1B2(BCI2,BCI3) end;

# B1DV
into method label _BIF code_regex \ECRD\s\(RefOf\s\(B1DV\)\) replaceall_matched begin B1B2(BDV0,BDV1) end;
into method label _BIX code_regex \ECRD\s\(RefOf\s\(B1DV\)\) replaceall_matched begin B1B2(BDV0,BDV1) end;
into method label _BST code_regex \ECRD\s\(RefOf\s\(B1DV\)\) replaceall_matched begin B1B2(BDV0,BDV1) end;

into_all all code_regex \(B1DV, replaceall_matched begin (B1B2(BDV0,BDV1), end;
into method label _BLT code_regex \ECRD\s\([\s]+RefOf\s\(B1FV\)\) replaceall_matched begin B1B2(BFV0,BFV1) end;
into method label _BLT code_regex \ECRD\s\(RefOf\s\([\s]+B1FV\)\) replaceall_matched begin B1B2(BFV0,BFV1) end;
into method label _BTP code_regex \ECRD\s\(RefOf\s\([\s]+B1FV\)\) replaceall_matched begin B1B2(BFV0,BFV1) end;
into method label _BIF code_regex \ECRD\s\(RefOf\s\(B1DV\)\) replaceall_matched begin B1B2(BDV0,BDV1) end;
into method label _BIF code_regex \ECRD\s\(RefOf\s\(B1DC\)\) replaceall_matched begin B1B2(BDC0,BDC1) end;

into device label H_EC code_regex (BMFG,)\s+(72) replace_matched begin BMF0,%2,//%1%2 end;

# OperationRegion (ECF3, EmbeddedControl, Zero, 0xFF)
# Field (ECF3, ByteAcc, Lock, Preserve)
# {
# ...
#                Offset (0x83), 
#                BTY,    8, //83
#                BDCH,   8, //84
#                BDCL,   8,//85 
#                BFCH,   8, //86
#                BFCL,   8, //87
#                BDVH,   8, //88
#                BDVL,   8, //89
#                BWCH,   8, //8a
#                BWCL,   8, //8b
#                BLCH,   8, //8c
#                BLCL,   8, //8d
#                BCG1,   16, //8e
#                BCG2,   16, //90
#                BSNH,   8, //92
#                BSNL,   8, //93
#                BPRH,   8, //94
#                BPRL,   8, //95
#                BRCH,   8, //96
#                BRCL,   8, //97
#                BPVH,   8, //98
#                BPVL,   8, //99
#                BTP,    16, //9a
#                CBT,    16, //9c
#                BMFG,   72, //9e

into method label XBIF code_regex \(BMFG, replaceall_matched begin (RECB(0x9e,72), end;
